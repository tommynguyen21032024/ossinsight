+------------------------------------------------+---------------+--------------+----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id                                             | estRows       | task         | access object                                                                                | operator info                                                                                                                                                                                                                                                                              |
+------------------------------------------------+---------------+--------------+----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| CTEFullScan_173                                | 8.00          | root         | CTE:tmp1                                                                                     | data:CTE_3                                                                                                                                                                                                                                                                                 |
| CTE_3                                          | 8.00          | root         |                                                                                              | Non-Recursive CTE                                                                                                                                                                                                                                                                          |
| └─Projection_165(Seed Part)                    | 8.00          | root         |                                                                                              | gharchive_dev.github_events.event_year, Column#84, Column#87                                                                                                                                                                                                                               |
|   └─Sort_166                                   | 8.00          | root         |                                                                                              | gharchive_dev.github_events.event_year, Column#84                                                                                                                                                                                                                                          |
|     └─Shuffle_171                              | 8.00          | root         |                                                                                              | execution info: concurrency:5, data sources:[CTEFullScan_169]                                                                                                                                                                                                                              |
|       └─Window_168                             | 8.00          | root         |                                                                                              | sum(cast(Column#85, decimal(20,0) BINARY))->Column#87 over(partition by Column#84 order by gharchive_dev.github_events.event_year range between unbounded preceding and current row)                                                                                                       |
|         └─Sort_170                             | 8.00          | root         |                                                                                              | Column#84, gharchive_dev.github_events.event_year                                                                                                                                                                                                                                          |
|           └─CTEFullScan_169                    | 8.00          | root         | CTE:tmp                                                                                      | data:CTE_2                                                                                                                                                                                                                                                                                 |
| CTE_2                                          | 8.00          | root         |                                                                                              | Non-Recursive CTE                                                                                                                                                                                                                                                                          |
| └─Sort_111(Seed Part)                          | 8.00          | root         |                                                                                              | gharchive_dev.github_events.event_year, Column#80                                                                                                                                                                                                                                          |
|   └─Projection_113                             | 8.00          | root         |                                                                                              | gharchive_dev.github_events.event_year, Column#80, Column#82                                                                                                                                                                                                                               |
|     └─HashAgg_114                              | 8.00          | root         |                                                                                              | group by:Column#80, gharchive_dev.github_events.event_year, funcs:count(1)->Column#82, funcs:firstrow(gharchive_dev.github_events.event_year)->gharchive_dev.github_events.event_year, funcs:firstrow(Column#80)->Column#80                                                                |
|       └─Projection_115                         | 143.61        | root         |                                                                                              | gharchive_dev.github_events.event_year, Column#80                                                                                                                                                                                                                                          |
|         └─IndexJoin_121                        | 143.61        | root         |                                                                                              | inner join, inner:IndexLookUp_120, outer key:gharchive_dev.github_events.repo_id, inner key:gharchive_dev.github_events.repo_id, equal cond:eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)                                                                   |
|           ├─Selection_126(Build)               | 8.00          | root         |                                                                                              | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                           |
|           │ └─CTEFullScan_127                  | 10.00         | root         | CTE:tr                                                                                       | data:CTE_1                                                                                                                                                                                                                                                                                 |
|           └─IndexLookUp_120(Probe)             | 17.95         | root         | partition:watch_event                                                                        |                                                                                                                                                                                                                                                                                            |
|             ├─Selection_118(Build)             | 20.79         | cop[tikv]    |                                                                                              | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                           |
|             │ └─IndexRangeScan_116             | 20.79         | cop[tikv]    | table:github_events, index:index_github_events_on_repo_id_type_number(repo_id, type, number) | range: decided by [eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id) eq(gharchive_dev.github_events.type, WatchEvent)], keep order:false                                                                                                                        |
|             └─Selection_119(Probe)             | 17.95         | cop[tikv]    |                                                                                              | le(gharchive_dev.github_events.event_year, 2021)                                                                                                                                                                                                                                           |
|               └─TableRowIDScan_117             | 20.79         | cop[tikv]    | table:github_events                                                                          | keep order:false                                                                                                                                                                                                                                                                           |
| CTE_1                                          | 10.00         | root         |                                                                                              | Non-Recursive CTE                                                                                                                                                                                                                                                                          |
| └─TopN_98(Seed Part)                           | 10.00         | root         |                                                                                              | Column#43:desc, offset:0, count:10                                                                                                                                                                                                                                                         |
|   └─CTEFullScan_105                            | 825.74        | root         | CTE:rs                                                                                       | data:CTE_0                                                                                                                                                                                                                                                                                 |
| CTE_0                                          | 825.74        | root         |                                                                                              | Non-Recursive CTE                                                                                                                                                                                                                                                                          |
| └─Projection_35(Seed Part)                     | 825.74        | root         |                                                                                              | gharchive_dev.github_events.repo_id, any_value(gharchive_dev.db_repos.name)->Column#40, Column#39                                                                                                                                                                                          |
|   └─TableReader_85                             | 825.74        | root         | table of repos, partition:watch_event of github_events                                       | data:ExchangeSender_84                                                                                                                                                                                                                                                                     |
|     └─ExchangeSender_84                        | 825.74        | mpp[tiflash] |                                                                                              | ExchangeType: PassThrough                                                                                                                                                                                                                                                                  |
|       └─Projection_83                          | 825.74        | mpp[tiflash] |                                                                                              | Column#39, gharchive_dev.github_events.repo_id, gharchive_dev.db_repos.name                                                                                                                                                                                                                |
|         └─HashAgg_37                           | 825.74        | mpp[tiflash] |                                                                                              | group by:gharchive_dev.github_events.repo_id, funcs:count(distinct gharchive_dev.github_events.actor_login)->Column#39, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id, funcs:firstrow(gharchive_dev.db_repos.name)->gharchive_dev.db_repos.name |
|           └─ExchangeReceiver_82                | 825.74        | mpp[tiflash] |                                                                                              |                                                                                                                                                                                                                                                                                            |
|             └─ExchangeSender_81                | 825.74        | mpp[tiflash] |                                                                                              | ExchangeType: HashPartition, Hash Cols: [name: gharchive_dev.github_events.repo_id, collate: binary]                                                                                                                                                                                       |
|               └─Projection_79                  | 825.74        | mpp[tiflash] |                                                                                              | gharchive_dev.github_events.repo_id, gharchive_dev.github_events.actor_login, gharchive_dev.db_repos.name                                                                                                                                                                                  |
|                 └─HashJoin_80                  | 825.74        | mpp[tiflash] |                                                                                              | inner join, equal:[eq(Column#96, Column#95)]                                                                                                                                                                                                                                               |
|                   ├─ExchangeReceiver_54(Build) | 46.00         | mpp[tiflash] |                                                                                              |                                                                                                                                                                                                                                                                                            |
|                   │ └─ExchangeSender_53        | 46.00         | mpp[tiflash] |                                                                                              | ExchangeType: Broadcast                                                                                                                                                                                                                                                                    |
|                   │   └─Projection_51          | 46.00         | mpp[tiflash] |                                                                                              | gharchive_dev.db_repos.name, cast(gharchive_dev.db_repos.id, double BINARY)->Column#96                                                                                                                                                                                                     |
|                   │     └─TableFullScan_52     | 46.00         | mpp[tiflash] | table:repos                                                                                  | keep order:false, stats:pseudo                                                                                                                                                                                                                                                             |
|                   └─Projection_55(Probe)       | 323181426.30  | mpp[tiflash] |                                                                                              | gharchive_dev.github_events.repo_id, gharchive_dev.github_events.actor_login, cast(gharchive_dev.github_events.repo_id, double BINARY)->Column#95                                                                                                                                          |
|                     └─Selection_57             | 323181426.30  | mpp[tiflash] |                                                                                              | eq(gharchive_dev.github_events.type, "WatchEvent")                                                                                                                                                                                                                                         |
|                       └─TableFullScan_56       | 4928742742.00 | mpp[tiflash] | table:github_events                                                                          | keep order:false, PartitionTableScan:true                                                                                                                                                                                                                                                  |
+------------------------------------------------+---------------+--------------+----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
