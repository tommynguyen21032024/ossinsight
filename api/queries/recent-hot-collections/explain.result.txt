+--------------------------------------------+-----------+-----------+------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id                                         | estRows   | task      | access object                                                          | operator info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+--------------------------------------------+-----------+-----------+------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Projection_70                              | 136.53    | root      |                                                                        | gharchive_dev.collections.id, gharchive_dev.collections.name, Column#22, gharchive_dev.collection_items.repo_id, gharchive_dev.collection_items.repo_name, Column#27, gharchive_dev.collection_items.last_month_rank, gharchive_dev.collection_items.last_2nd_month_rank, Column#24, Column#28                                                                                                                                                                                                               |
| └─Selection_71                             | 136.53    | root      |                                                                        | le(Column#27, 3)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|   └─Window_72                              | 170.67    | root      |                                                                        | count(1)->Column#28 over(partition by gharchive_dev.collection_items.collection_id)                                                                                                                                                                                                                                                                                                                                                                                                                          |
|     └─Window_73                            | 170.67    | root      |                                                                        | row_number()->Column#27 over(partition by gharchive_dev.collection_items.collection_id order by Column#26 rows between current row and current row)                                                                                                                                                                                                                                                                                                                                                          |
|       └─Sort_104                           | 170.67    | root      |                                                                        | gharchive_dev.collection_items.collection_id, Column#26                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|         └─Projection_75                    | 170.67    | root      |                                                                        | gharchive_dev.collections.id, gharchive_dev.collections.name, Column#22, gharchive_dev.collection_items.repo_id, gharchive_dev.collection_items.repo_name, gharchive_dev.collection_items.last_month_rank, gharchive_dev.collection_items.last_2nd_month_rank, minus(gharchive_dev.collection_items.last_2nd_month_rank, gharchive_dev.collection_items.last_month_rank)->Column#24, gharchive_dev.collection_items.collection_id, ifnull(gharchive_dev.collection_items.last_month_rank, 999999)->Column#26 |
|           └─Projection_76                  | 170.67    | root      |                                                                        | gharchive_dev.collection_items.collection_id, gharchive_dev.collection_items.repo_name, gharchive_dev.collection_items.repo_id, gharchive_dev.collection_items.last_month_rank, gharchive_dev.collection_items.last_2nd_month_rank, gharchive_dev.collections.id, gharchive_dev.collections.name, Column#22                                                                                                                                                                                                  |
|             └─IndexJoin_81                 | 170.67    | root      |                                                                        | inner join, inner:IndexLookUp_80, outer key:gharchive_dev.collections.id, inner key:gharchive_dev.collection_items.collection_id, equal cond:eq(gharchive_dev.collections.id, gharchive_dev.collection_items.collection_id)                                                                                                                                                                                                                                                                                  |
|               ├─Selection_93(Build)        | 8.00      | root      |                                                                        | not(isnull(gharchive_dev.collections.id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               │ └─CTEFullScan_94           | 10.00     | root      | CTE:tc                                                                 | data:CTE_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               └─IndexLookUp_80(Probe)      | 21.33     | root      |                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                 ├─Selection_79(Build)      | 21.33     | cop[tikv] |                                                                        | not(isnull(gharchive_dev.collection_items.collection_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                 │ └─IndexRangeScan_77      | 21.33     | cop[tikv] | table:ci, index:index_collection_items_on_collection_id(collection_id) | range: decided by [eq(gharchive_dev.collection_items.collection_id, gharchive_dev.collections.id)], keep order:false                                                                                                                                                                                                                                                                                                                                                                                         |
|                 └─TableRowIDScan_78(Probe) | 21.33     | cop[tikv] | table:ci                                                               | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CTE_1                                      | 10.00     | root      |                                                                        | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| └─Projection_48(Seed Part)                 | 10.00     | root      |                                                                        | gharchive_dev.collections.id, gharchive_dev.collections.name, Column#10                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|   └─IndexJoin_53                           | 10.00     | root      |                                                                        | inner join, inner:TableReader_50, outer key:Column#9, inner key:gharchive_dev.collections.id, equal cond:eq(Column#9, gharchive_dev.collections.id)                                                                                                                                                                                                                                                                                                                                                          |
|     ├─Selection_60(Build)                  | 8.00      | root      |                                                                        | not(isnull(Column#9))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     │ └─CTEFullScan_61                     | 10.00     | root      | CTE:cv                                                                 | data:CTE_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|     └─TableReader_50(Probe)                | 1.00      | root      |                                                                        | data:TableRangeScan_49                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       └─TableRangeScan_49                  | 1.00      | cop[tikv] | table:c                                                                | range: decided by [Column#9], keep order:false, stats:pseudo                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| CTE_0                                      | 10.00     | root      |                                                                        | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| └─Projection_29(Seed Part)                 | 10.00     | root      |                                                                        | cast(json_extract(gharchive_dev.access_logs.request_params, $.collectionId), bigint(22) BINARY)->Column#8, Column#7                                                                                                                                                                                                                                                                                                                                                                                          |
|   └─TopN_32                                | 10.00     | root      |                                                                        | Column#7:desc, offset:0, count:10                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|     └─HashAgg_42                           | 11096.68  | root      |                                                                        | group by:Column#40, funcs:count(Column#41)->Column#7, funcs:firstrow(Column#42)->gharchive_dev.access_logs.request_params                                                                                                                                                                                                                                                                                                                                                                                    |
|       └─TableReader_43                     | 11096.68  | root      |                                                                        | data:HashAgg_37                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|         └─HashAgg_37                       | 11096.68  | cop[tikv] |                                                                        | group by:cast(json_extract(gharchive_dev.access_logs.request_params, "$.collectionId"), bigint(22) BINARY), funcs:count(1)->Column#41, funcs:firstrow(gharchive_dev.access_logs.request_params)->Column#42                                                                                                                                                                                                                                                                                                   |
|           └─Selection_41                   | 127554.40 | cop[tikv] |                                                                        | gt(gharchive_dev.access_logs.requested_at, 2022-07-24 03:21:15), like(gharchive_dev.access_logs.request_path, "/q/collection-%", 92)                                                                                                                                                                                                                                                                                                                                                                         |
|             └─TableFullScan_40             | 159443.00 | cop[tikv] | table:access_logs                                                      | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+--------------------------------------------+-----------+-----------+------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
