+-------------------------------------------------------------------+---------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id                                                                | estRows       | task         | access object                                                                                                                             | operator info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+-------------------------------------------------------------------+---------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Sort_517                                                          | 12.80         | root         |                                                                                                                                           | Column#270:desc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| └─Projection_519                                                  | 12.80         | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, Column#268, Column#269, Column#270, ifnull(Column#278, 0)->Column#281, ifnull(Column#280, 0)->Column#282, ifnull(Column#272, 0)->Column#283, Column#274, Column#276                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|   └─Projection_520                                                | 12.80         | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, Column#268, Column#269, Column#270, Column#272, Column#274, Column#276, Column#278, Column#280                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|     └─HashJoin_522                                                | 12.80         | root         |                                                                                                                                           | left outer join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|       ├─HashJoin_524(Build)                                       | 12.80         | root         |                                                                                                                                           | left outer join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|       │ ├─HashJoin_526(Build)                                     | 12.80         | root         |                                                                                                                                           | inner join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       │ │ ├─HashJoin_528(Build)                                   | 12.80         | root         |                                                                                                                                           | left outer join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|       │ │ │ ├─HashJoin_529(Build)                                 | 12.80         | root         |                                                                                                                                           | left outer join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|       │ │ │ │ ├─Selection_533(Build)                              | 10.24         | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       │ │ │ │ │ └─CTEFullScan_534                                 | 12.80         | root         | CTE:rc                                                                                                                                    | data:CTE_2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|       │ │ │ │ └─Selection_531(Probe)                              | 12.80         | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       │ │ │ │   └─CTEFullScan_532                                 | 16.00         | root         | CTE:tr                                                                                                                                    | data:CTE_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|       │ │ │ └─Selection_535(Probe)                                | 117.64        | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       │ │ │   └─CTEFullScan_536                                   | 147.05        | root         | CTE:tc                                                                                                                                    | data:CTE_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|       │ │ └─Selection_537(Probe)                                  | 147.05        | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       │ │   └─CTEFullScan_538                                     | 183.82        | root         | CTE:e                                                                                                                                     | data:CTE_3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|       │ └─Selection_539(Probe)                                    | 147.05        | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       │   └─CTEFullScan_540                                       | 183.82        | root         | CTE:p                                                                                                                                     | data:CTE_4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|       └─Selection_541(Probe)                                      | 147.05        | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|         └─CTEFullScan_542                                         | 183.82        | root         | CTE:pr                                                                                                                                    | data:CTE_5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CTE_2                                                             | 12.80         | root         |                                                                                                                                           | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| └─Projection_344(Seed Part)                                       | 12.80         | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, Column#140                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|   └─HashAgg_345                                                   | 12.80         | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:group_concat(distinct gharchive_dev.collections.name separator ",")->Column#140, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|     └─IndexJoin_353                                               | 14.25         | root         |                                                                                                                                           | inner join, inner:TableReader_349, outer key:gharchive_dev.collection_items.collection_id, inner key:gharchive_dev.collections.id, equal cond:eq(gharchive_dev.collection_items.collection_id, gharchive_dev.collections.id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|       ├─HashJoin_361(Build)                                       | 14.25         | root         |                                                                                                                                           | inner join, equal:[eq(Column#128, gharchive_dev.collection_items.repo_name)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|       │ ├─Selection_362(Build)                                    | 12.80         | root         |                                                                                                                                           | not(isnull(Column#128)), not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|       │ │ └─CTEFullScan_363                                       | 16.00         | root         | CTE:tr                                                                                                                                    | data:CTE_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|       │ └─TableReader_366(Probe)                                  | 1218.00       | root         |                                                                                                                                           | data:Selection_365                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|       │   └─Selection_365                                         | 1218.00       | cop[tikv]    |                                                                                                                                           | not(isnull(gharchive_dev.collection_items.collection_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|       │     └─TableFullScan_364                                   | 1218.00       | cop[tikv]    | table:ci                                                                                                                                  | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       └─TableReader_349(Probe)                                    | 1.00          | root         |                                                                                                                                           | data:Selection_348                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|         └─Selection_348                                           | 1.00          | cop[tikv]    |                                                                                                                                           | eq(gharchive_dev.collections.public, 1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|           └─TableRangeScan_347                                    | 1.00          | cop[tikv]    | table:c                                                                                                                                   | range: decided by [gharchive_dev.collection_items.collection_id], keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| CTE_0                                                             | 16.00         | root         |                                                                                                                                           | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| └─Selection_105(Seed Part)                                        | 16.00         | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|   └─Projection_106                                                | 20.00         | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, any_value(gharchive_dev.github_events.repo_name)->Column#77, any_value(Column#71)->Column#78, Column#76                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|     └─TopN_110                                                    | 20.00         | root         |                                                                                                                                           | Column#76:desc, offset:0, count:20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|       └─TableReader_240                                           | 20.00         | root         | partition:watch_event of ge, partition:pull_request_event of ge2, table of bu, table of br                                                | data:ExchangeSender_239                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|         └─ExchangeSender_239                                      | 20.00         | mpp[tiflash] |                                                                                                                                           | ExchangeType: PassThrough                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|           └─TopN_238                                              | 20.00         | mpp[tiflash] |                                                                                                                                           | Column#76:desc, offset:0, count:20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|             └─Projection_234                                      | 12579.88      | mpp[tiflash] |                                                                                                                                           | Column#76, gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_name, Column#71                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               └─HashAgg_235                                       | 12579.88      | mpp[tiflash] |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:count(distinct gharchive_dev.github_events.actor_id)->Column#76, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id, funcs:firstrow(Column#301)->gharchive_dev.github_events.repo_name, funcs:firstrow(Column#302)->Column#71                                                                                                                                                                                                                                                                                                                                                                                                                |
|                 └─ExchangeReceiver_237                            | 12579.88      | mpp[tiflash] |                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                   └─ExchangeSender_236                            | 12579.88      | mpp[tiflash] |                                                                                                                                           | ExchangeType: HashPartition, Hash Cols: [name: gharchive_dev.github_events.repo_id, collate: binary]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                     └─HashAgg_232                                 | 12579.88      | mpp[tiflash] |                                                                                                                                           | group by:gharchive_dev.github_events.actor_id, gharchive_dev.github_events.repo_id, funcs:firstrow(gharchive_dev.github_events.repo_name)->Column#301, funcs:firstrow(Column#71)->Column#302                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                       └─HashJoin_221                              | 225819.34     | mpp[tiflash] |                                                                                                                                           | CARTESIAN anti semi join, other cond:eq(gharchive_dev.github_events.repo_name, gharchive_dev.blacklist_repos.name)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                         ├─ExchangeReceiver_150(Build)             | 1.00          | mpp[tiflash] |                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                         │ └─ExchangeSender_149                    | 1.00          | mpp[tiflash] |                                                                                                                                           | ExchangeType: Broadcast                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                         │   └─TableFullScan_148                   | 1.00          | mpp[tiflash] | table:br                                                                                                                                  | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                         └─HashJoin_124(Probe)                     | 282274.17     | mpp[tiflash] |                                                                                                                                           | CARTESIAN anti semi join, other cond:eq(gharchive_dev.github_events.actor_login, gharchive_dev.blacklist_users.login)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                           ├─ExchangeReceiver_147(Build)           | 1.00          | mpp[tiflash] |                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                           │ └─ExchangeSender_146                  | 1.00          | mpp[tiflash] |                                                                                                                                           | ExchangeType: Broadcast                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                           │   └─TableFullScan_145                 | 1.00          | mpp[tiflash] | table:bu                                                                                                                                  | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                           └─HashJoin_125(Probe)                   | 352842.72     | mpp[tiflash] |                                                                                                                                           | inner join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                             ├─ExchangeReceiver_144(Build)         | 49786.75      | mpp[tiflash] |                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                             │ └─ExchangeSender_143                | 49786.75      | mpp[tiflash] |                                                                                                                                           | ExchangeType: Broadcast                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                             │   └─Selection_129                   | 49786.75      | mpp[tiflash] |                                                                                                                                           | eq(Column#71, "Java")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                             │     └─Projection_139                | 62233.44      | mpp[tiflash] |                                                                                                                                           | Column#71, gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                             │       └─HashAgg_140                 | 62233.44      | mpp[tiflash] |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:min(Column#286)->Column#71, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|                             │         └─ExchangeReceiver_142      | 62233.44      | mpp[tiflash] |                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                             │           └─ExchangeSender_141      | 62233.44      | mpp[tiflash] |                                                                                                                                           | ExchangeType: HashPartition, Hash Cols: [name: gharchive_dev.github_events.repo_id, collate: binary]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                             │             └─HashAgg_131           | 62233.44      | mpp[tiflash] |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:min(gharchive_dev.github_events.language)->Column#286                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                             │               └─Selection_138       | 1117141.73    | mpp[tiflash] |                                                                                                                                           | eq(gharchive_dev.github_events.type, "PullRequestEvent"), ge(gharchive_dev.github_events.created_at, 2022-08-15 04:04:56), lt(gharchive_dev.github_events.created_at, 2022-08-29 04:04:56), not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                             │                 └─TableFullScan_137 | 4944819286.00 | mpp[tiflash] | table:ge2                                                                                                                                 | keep order:false, PartitionTableScan:true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                             └─Selection_127(Probe)                | 352842.72     | mpp[tiflash] |                                                                                                                                           | eq(gharchive_dev.github_events.action, "started"), eq(gharchive_dev.github_events.type, "WatchEvent"), ge(gharchive_dev.github_events.created_at, 2022-04-04 02:59:59.000000), le(gharchive_dev.github_events.created_at, 2022-05-04 02:59:59.000000), not(isnull(gharchive_dev.github_events.repo_id)), not(like(gharchive_dev.github_events.actor_login, "%bot%", 92))                                                                                                                                                                                                                                                                                                                                                               |
|                               └─TableFullScan_126                 | 4944819286.00 | mpp[tiflash] | table:ge                                                                                                                                  | keep order:false, PartitionTableScan:true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| CTE_1                                                             | 147.05        | root         |                                                                                                                                           | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| └─Projection_308(Seed Part)                                       | 147.05        | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, Column#126                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|   └─StreamAgg_310                                                 | 147.05        | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:group_concat(distinct gharchive_dev.github_events.actor_login separator ",")->Column#126, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|     └─Selection_338                                               | 147.05        | root         |                                                                                                                                           | le(Column#122, 5)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|       └─Window_339                                                | 183.82        | root         |                                                                                                                                           | row_number()->Column#122 over(partition by gharchive_dev.github_events.repo_id order by Column#120 desc rows between current row and current row)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|         └─Sort_313                                                | 183.82        | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, Column#120:desc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|           └─HashAgg_317                                           | 183.82        | root         |                                                                                                                                           | group by:gharchive_dev.github_events.actor_login, gharchive_dev.github_events.repo_id, funcs:count(1)->Column#120, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id, funcs:firstrow(gharchive_dev.github_events.actor_login)->gharchive_dev.github_events.actor_login                                                                                                                                                                                                                                                                                                                                                                                                                          |
|             └─HashJoin_318                                        | 183.82        | root         |                                                                                                                                           | CARTESIAN anti semi join, other cond:eq(gharchive_dev.github_events.actor_login, gharchive_dev.blacklist_users.login)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               ├─IndexReader_333(Build)                            | 1.00          | root         |                                                                                                                                           | index:IndexFullScan_332                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               │ └─IndexFullScan_332                               | 1.00          | cop[tikv]    | table:bu, index:blacklist_users_login_uindex(login)                                                                                       | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               └─HashJoin_321(Probe)                               | 229.77        | root         |                                                                                                                                           | inner join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                 ├─HashAgg_322(Build)                              | 12.80         | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                 │ └─Selection_323                                 | 12.80         | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                 │   └─CTEFullScan_324                             | 16.00         | root         | CTE:tr                                                                                                                                    | data:CTE_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                 └─TableReader_327(Probe)                          | 30845039.32   | root         | partition:push_event,pull_request_event,issues_event,pull_request_review_event                                                            | data:Selection_326                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                   └─Selection_326                                 | 30845039.32   | cop[tiflash] |                                                                                                                                           | ge(gharchive_dev.github_events.created_at, 2022-04-04 02:59:59.000000), le(gharchive_dev.github_events.created_at, 2022-05-04 02:59:59.000000), not(isnull(gharchive_dev.github_events.repo_id)), not(like(gharchive_dev.github_events.actor_login, "%bot%", 92)), or(or(and(eq(gharchive_dev.github_events.type, "PullRequestEvent"), eq(gharchive_dev.github_events.action, "opened")), and(eq(gharchive_dev.github_events.type, "IssuesEvent"), eq(gharchive_dev.github_events.action, "opened"))), or(and(eq(gharchive_dev.github_events.type, "PullRequestReviewEvent"), eq(gharchive_dev.github_events.action, "created")), and(eq(gharchive_dev.github_events.type, "PushEvent"), isnull(gharchive_dev.github_events.action)))) |
|                     └─TableFullScan_325                           | 4944819286.00 | cop[tiflash] | table:ge                                                                                                                                  | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| CTE_3                                                             | 183.82        | root         |                                                                                                                                           | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| └─Projection_245(Seed Part)                                       | 183.82        | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, Column#182                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|   └─HashAgg_246                                                   | 183.82        | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:count(1)->Column#182, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|     └─HashJoin_251                                                | 183.82        | root         |                                                                                                                                           | CARTESIAN anti semi join, other cond:eq(gharchive_dev.github_events.actor_login, gharchive_dev.blacklist_users.login)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|       ├─IndexReader_301(Build)                                    | 1.00          | root         |                                                                                                                                           | index:IndexFullScan_300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|       │ └─IndexFullScan_300                                       | 1.00          | cop[tikv]    | table:bu, index:blacklist_users_login_uindex(login)                                                                                       | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       └─IndexJoin_258(Probe)                                      | 229.77        | root         |                                                                                                                                           | inner join, inner:IndexLookUp_257, outer key:gharchive_dev.github_events.repo_id, inner key:gharchive_dev.github_events.repo_id, equal cond:eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|         ├─HashAgg_263(Build)                                      | 12.80         | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|         │ └─Selection_264                                         | 12.80         | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|         │   └─CTEFullScan_265                                     | 16.00         | root         | CTE:tr                                                                                                                                    | data:CTE_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|         └─IndexLookUp_257(Probe)                                  | 17.95         | root         | partition:all                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|           ├─Selection_255(Build)                                  | 865.41        | cop[tikv]    |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id)), not(like(gharchive_dev.github_events.actor_login, "%bot%", 92))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|           │ └─IndexRangeScan_253                                  | 1081.77       | cop[tikv]    | table:ge, index:index_github_events_on_repo_id_type_action_month_actor_login(repo_id, type, action, event_month, actor_login)             | range: decided by [eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)], keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|           └─Selection_256(Probe)                                  | 17.95         | cop[tikv]    |                                                                                                                                           | ge(gharchive_dev.github_events.created_at, 2022-04-04 02:59:59.000000), le(gharchive_dev.github_events.created_at, 2022-05-04 02:59:59.000000)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|             └─TableRowIDScan_254                                  | 865.41        | cop[tikv]    | table:ge                                                                                                                                  | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| CTE_4                                                             | 183.82        | root         |                                                                                                                                           | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| └─Projection_383(Seed Part)                                       | 183.82        | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, Column#224                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|   └─HashAgg_384                                                   | 183.82        | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:count(1)->Column#224, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|     └─HashJoin_389                                                | 183.82        | root         |                                                                                                                                           | CARTESIAN anti semi join, other cond:eq(gharchive_dev.github_events.actor_login, gharchive_dev.blacklist_users.login)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|       ├─IndexReader_439(Build)                                    | 1.00          | root         |                                                                                                                                           | index:IndexFullScan_438                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|       │ └─IndexFullScan_438                                       | 1.00          | cop[tikv]    | table:bu, index:blacklist_users_login_uindex(login)                                                                                       | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       └─IndexJoin_396(Probe)                                      | 229.77        | root         |                                                                                                                                           | inner join, inner:IndexLookUp_395, outer key:gharchive_dev.github_events.repo_id, inner key:gharchive_dev.github_events.repo_id, equal cond:eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|         ├─HashAgg_401(Build)                                      | 12.80         | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|         │ └─Selection_402                                         | 12.80         | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|         │   └─CTEFullScan_403                                     | 16.00         | root         | CTE:tr                                                                                                                                    | data:CTE_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|         └─IndexLookUp_395(Probe)                                  | 17.95         | root         | partition:push_event                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|           ├─Selection_393(Build)                                  | 865.41        | cop[tikv]    |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id)), not(like(gharchive_dev.github_events.actor_login, "%bot%", 92))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|           │ └─IndexRangeScan_391                                  | 1081.77       | cop[tikv]    | table:ge, index:index_github_events_on_repo_id_type_action_month_actor_login(repo_id, type, action, event_month, actor_login)             | range: decided by [eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id) eq(gharchive_dev.github_events.type, PushEvent) isnull(gharchive_dev.github_events.action)], keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|           └─Selection_394(Probe)                                  | 17.95         | cop[tikv]    |                                                                                                                                           | ge(gharchive_dev.github_events.created_at, 2022-04-04 02:59:59.000000), le(gharchive_dev.github_events.created_at, 2022-05-04 02:59:59.000000)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|             └─TableRowIDScan_392                                  | 865.41        | cop[tikv]    | table:ge                                                                                                                                  | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| CTE_5                                                             | 183.82        | root         |                                                                                                                                           | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| └─Projection_446(Seed Part)                                       | 183.82        | root         |                                                                                                                                           | gharchive_dev.github_events.repo_id, Column#266                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|   └─HashAgg_447                                                   | 183.82        | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:count(1)->Column#266, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|     └─HashJoin_452                                                | 183.82        | root         |                                                                                                                                           | CARTESIAN anti semi join, other cond:eq(gharchive_dev.github_events.actor_login, gharchive_dev.blacklist_users.login)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|       ├─IndexReader_502(Build)                                    | 1.00          | root         |                                                                                                                                           | index:IndexFullScan_501                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|       │ └─IndexFullScan_501                                       | 1.00          | cop[tikv]    | table:bu, index:blacklist_users_login_uindex(login)                                                                                       | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       └─IndexJoin_459(Probe)                                      | 229.77        | root         |                                                                                                                                           | inner join, inner:IndexLookUp_458, outer key:gharchive_dev.github_events.repo_id, inner key:gharchive_dev.github_events.repo_id, equal cond:eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|         ├─HashAgg_464(Build)                                      | 12.80         | root         |                                                                                                                                           | group by:gharchive_dev.github_events.repo_id, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|         │ └─Selection_465                                         | 12.80         | root         |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|         │   └─CTEFullScan_466                                     | 16.00         | root         | CTE:tr                                                                                                                                    | data:CTE_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|         └─IndexLookUp_458(Probe)                                  | 17.95         | root         | partition:pull_request_event                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|           ├─Selection_456(Build)                                  | 22.44         | cop[tikv]    |                                                                                                                                           | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|           │ └─IndexRangeScan_454                                  | 22.44         | cop[tikv]    | table:ge, index:index_ge_on_repo_id_type_action_created_at_pdsize_psize(repo_id, type, action, created_at, push_distinct_size, push_size) | range: decided by [eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id) eq(gharchive_dev.github_events.type, PullRequestEvent) eq(gharchive_dev.github_events.action, opened) ge(gharchive_dev.github_events.created_at, 2022-04-04 02:59:59.000000) le(gharchive_dev.github_events.created_at, 2022-05-04 02:59:59.000000)], keep order:false                                                                                                                                                                                                                                                                                                                                                                 |
|           └─Selection_457(Probe)                                  | 17.95         | cop[tikv]    |                                                                                                                                           | not(like(gharchive_dev.github_events.actor_login, "%bot%", 92))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|             └─TableRowIDScan_455                                  | 22.44         | cop[tikv]    | table:ge                                                                                                                                  | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+-------------------------------------------------------------------+---------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
