+------------------------------------+-----------+-----------+------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id                                 | estRows   | task      | access object                                                                                                                            | operator info                                                                                                                                                                                                                                                                                                                                                                                                   |
+------------------------------------+-----------+-----------+------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Sort_132                           | 0.51      | root      |                                                                                                                                          | Column#98                                                                                                                                                                                                                                                                                                                                                                                                       |
| └─Projection_134                   | 0.51      | root      |                                                                                                                                          | gharchive_dev.github_events.repo_id, Column#90, ifnull(Column#91, 0)->Column#97, ifnull(Column#92, 0)->Column#98, ifnull(Column#95, 0)->Column#99, ifnull(Column#96, 0)->Column#100, ifnull(mul(div(cast(minus(Column#91, Column#95), decimal(20,0) BINARY), cast(Column#95, decimal(20,0) BINARY)), 100), 0)->Column#101, ifnull(minus(Column#92, Column#96), 0)->Column#102, ifnull(Column#88, 0)->Column#103 |
|   └─Projection_135                 | 0.51      | root      |                                                                                                                                          | Column#88, gharchive_dev.github_events.repo_id, Column#90, Column#91, Column#92, Column#95, Column#96                                                                                                                                                                                                                                                                                                           |
|     └─HashJoin_136                 | 0.51      | root      |                                                                                                                                          | left outer join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                           |
|       ├─Selection_144(Build)       | 0.51      | root      |                                                                                                                                          | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                |
|       │ └─CTEFullScan_145          | 0.64      | root      | CTE:sl2p                                                                                                                                 | data:CTE_3                                                                                                                                                                                                                                                                                                                                                                                                      |
|       └─HashJoin_139(Probe)        | 0.51      | root      |                                                                                                                                          | inner join, equal:[eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id)]                                                                                                                                                                                                                                                                                                                |
|         ├─Selection_140(Build)     | 0.51      | root      |                                                                                                                                          | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                |
|         │ └─CTEFullScan_141        | 0.64      | root      | CTE:slp                                                                                                                                  | data:CTE_2                                                                                                                                                                                                                                                                                                                                                                                                      |
|         └─Selection_142(Probe)     | 3127.40   | root      |                                                                                                                                          | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                |
|           └─CTEFullScan_143        | 3909.25   | root      | CTE:pgr                                                                                                                                  | data:CTE_0                                                                                                                                                                                                                                                                                                                                                                                                      |
| CTE_3                              | 0.64      | root      |                                                                                                                                          | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                               |
| └─Projection_122(Seed Part)        | 0.64      | root      |                                                                                                                                          | gharchive_dev.github_events.repo_id, Column#83, Column#84, Column#86                                                                                                                                                                                                                                                                                                                                            |
|   └─Selection_123                  | 0.64      | root      |                                                                                                                                          | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                |
|     └─Window_124                   | 0.80      | root      |                                                                                                                                          | row_number()->Column#86 over(order by Column#84 desc rows between current row and current row)                                                                                                                                                                                                                                                                                                                  |
|       └─Sort_128                   | 0.80      | root      |                                                                                                                                          | Column#84:desc                                                                                                                                                                                                                                                                                                                                                                                                  |
|         └─Selection_126            | 0.80      | root      |                                                                                                                                          | eq(Column#81, 1)                                                                                                                                                                                                                                                                                                                                                                                                |
|           └─CTEFullScan_127        | 1.00      | root      | CTE:sgp                                                                                                                                  | data:CTE_1                                                                                                                                                                                                                                                                                                                                                                                                      |
| CTE_2                              | 0.64      | root      |                                                                                                                                          | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                               |
| └─Projection_113(Seed Part)        | 0.64      | root      |                                                                                                                                          | gharchive_dev.github_events.repo_id, Column#77, Column#78, Column#80                                                                                                                                                                                                                                                                                                                                            |
|   └─Selection_114                  | 0.64      | root      |                                                                                                                                          | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                |
|     └─Window_115                   | 0.80      | root      |                                                                                                                                          | row_number()->Column#80 over(order by Column#78 desc rows between current row and current row)                                                                                                                                                                                                                                                                                                                  |
|       └─Sort_119                   | 0.80      | root      |                                                                                                                                          | Column#78:desc                                                                                                                                                                                                                                                                                                                                                                                                  |
|         └─Selection_117            | 0.80      | root      |                                                                                                                                          | eq(Column#75, 0)                                                                                                                                                                                                                                                                                                                                                                                                |
|           └─CTEFullScan_118        | 1.00      | root      | CTE:sgp                                                                                                                                  | data:CTE_1                                                                                                                                                                                                                                                                                                                                                                                                      |
| CTE_0                              | 3909.25   | root      |                                                                                                                                          | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                               |
| └─Projection_33(Seed Part)         | 3909.25   | root      |                                                                                                                                          | gharchive_dev.github_events.repo_id, Column#36                                                                                                                                                                                                                                                                                                                                                                  |
|   └─HashAgg_52                     | 3909.25   | root      |                                                                                                                                          | group by:gharchive_dev.github_events.repo_id, funcs:count(Column#106)->Column#36, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id                                                                                                                                                                                                                                      |
|     └─IndexReader_53               | 3909.25   | root      | partition:watch_event                                                                                                                    | index:HashAgg_34                                                                                                                                                                                                                                                                                                                                                                                                |
|       └─HashAgg_34                 | 3909.25   | cop[tikv] |                                                                                                                                          | group by:gharchive_dev.github_events.repo_id, funcs:count(gharchive_dev.github_events.actor_login)->Column#106                                                                                                                                                                                                                                                                                                  |
|         └─Selection_51             | 148344.58 | cop[tikv] |                                                                                                                                          | not(isnull(gharchive_dev.github_events.repo_id))                                                                                                                                                                                                                                                                                                                                                                |
|           └─IndexRangeScan_50      | 148344.58 | cop[tikv] | table:github_events, index:index_github_events_on_repo_id_type_action_month_actor_login(repo_id, type, action, event_month, actor_login) | range:[16563587 "WatchEvent",16563587 "WatchEvent"], [41986369 "WatchEvent",41986369 "WatchEvent"], [105944401 "WatchEvent",105944401 "WatchEvent"], keep order:false                                                                                                                                                                                                                                           |
| CTE_1                              | 1.00      | root      |                                                                                                                                          | Non-Recursive CTE                                                                                                                                                                                                                                                                                                                                                                                               |
| └─Projection_82(Seed Part)         | 1.00      | root      |                                                                                                                                          | intdiv(datediff(2022-08-29, gharchive_dev.github_events.event_day), 28)->Column#73, gharchive_dev.github_events.repo_id, any_value(gharchive_dev.github_events.repo_name)->Column#74, Column#72                                                                                                                                                                                                                 |
|   └─HashAgg_84                     | 1.00      | root      |                                                                                                                                          | group by:Column#132, Column#133, funcs:count(Column#128)->Column#72, funcs:firstrow(Column#129)->gharchive_dev.github_events.repo_id, funcs:firstrow(Column#130)->gharchive_dev.github_events.repo_name, funcs:firstrow(Column#131)->gharchive_dev.github_events.event_day                                                                                                                                      |
|     └─Projection_112               | 1.98      | root      |                                                                                                                                          | gharchive_dev.github_events.actor_login, gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_name, gharchive_dev.github_events.event_day, intdiv(datediff(2022-08-29, gharchive_dev.github_events.event_day), 28)->Column#132, gharchive_dev.github_events.repo_id                                                                                                                            |
|       └─IndexLookUp_97             | 1.98      | root      | partition:watch_event                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                 |
|         ├─IndexRangeScan_91(Build) | 370.86    | cop[tikv] | table:github_events, index:index_github_events_on_repo_id_type_action_month_actor_login(repo_id, type, action, event_month, actor_login) | range:[16563587 "WatchEvent" "started" 2022-07-01,16563587 "WatchEvent" "started" 2022-08-01], [41986369 "WatchEvent" "started" 2022-07-01,41986369 "WatchEvent" "started" 2022-08-01], [105944401 "WatchEvent" "started" 2022-07-01,105944401 "WatchEvent" "started" 2022-08-01], keep order:false                                                                                                             |
|         └─Selection_93(Probe)      | 1.98      | cop[tikv] |                                                                                                                                          | gt(gharchive_dev.github_events.created_at, 2022-07-04)                                                                                                                                                                                                                                                                                                                                                          |
|           └─TableRowIDScan_92      | 370.86    | cop[tikv] | table:github_events                                                                                                                      | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                |
+------------------------------------+-----------+-----------+------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
